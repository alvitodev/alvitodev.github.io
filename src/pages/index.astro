---
import Layout from '../layouts/Layout.astro';
import Panel from '../components/Panel.astro'; // Import komponen baru
import { getCollection, type CollectionEntry } from 'astro:content';
import { Icon } from 'astro-icon/components'; // Pastikan sudah install astro-icon

const recentWriting: CollectionEntry<'writing'>[] = (await getCollection('writing')).slice(0, 3);
const recentWork: CollectionEntry<'work'>[] = (await getCollection('work')).slice(0, 3);
---

<Layout title="Command Center">
  <div class="grid grid-cols-1 md:grid-cols-12 gap-4 p-4 min-h-[80vh] content-center">
    
    {/* HEADER / WELCOME MODULE (Lebar penuh) */}
    <Panel class="md:col-span-12 flex flex-col md:flex-row items-center justify-between gap-4">
      <div>
        <h1 class="text-3xl font-mono font-bold text-white tracking-tighter">
          ALVITO<span class="text-amber-500">.DEV</span>
        </h1>
        <p class="text-zinc-400 font-mono text-xs mt-1">
          > SYSTEM_STATUS: <span class="text-green-500">ONLINE</span>
        </p>
      </div>
      <div class="text-right hidden md:block">
        <p class="text-xs text-zinc-500 font-mono">LOCATION: YOGYAKARTA, ID</p>
        <p class="text-xs text-zinc-500 font-mono">LAT: -7.7956 // LONG: 110.3695</p>
      </div>
    </Panel>

    {/* WRITING MODULE (Kiri, lebar 7 kolom) */}
    <Panel title="// RECENT_LOGS" class="md:col-span-7">
      <ul class="space-y-3">
        {recentWriting.map(post => (
          <li class="group/item flex items-baseline justify-between border-b border-zinc-800/50 pb-2 last:border-0 hover:pl-2 transition-all cursor-pointer">
            <a href={`/writing/${post.id}`} class="text-zinc-300 hover:text-amber-500 font-mono text-sm truncate pr-4 transition-colors">
              {post.data.title}
            </a>
            <span class="text-[10px] text-zinc-600 font-mono whitespace-nowrap">
              {post.data.publishDate.toLocaleDateString('en-GB')}
            </span>
          </li>
        ))}
      </ul>
    </Panel>

    {/* WORK MODULE (Kanan, lebar 5 kolom) */}
    <Panel title="// ACTIVE_TASKS" class="md:col-span-5">
      <div class="space-y-4">
        {recentWork.map(project => (
          <div class="flex items-center justify-between bg-zinc-950/50 p-3 border border-zinc-800">
            <div class="flex flex-col">
              <span class="text-zinc-200 text-sm font-bold">{project.data.title}</span>
              <span class="text-[10px] text-zinc-500 font-mono uppercase">{project.data.techStack[0]}</span>
            </div>
            <div class={`px-2 py-1 text-[10px] font-mono border ${project.data.status === 'completed' ? 'border-green-900 text-green-500 bg-green-900/20' : 'border-amber-900 text-amber-500 bg-amber-900/20'}`}>
              {project.data.status}
            </div>
          </div>
        ))}
      </div>
    </Panel>

    {/* FOOTER STATS (Lebar penuh) */}
    <Panel class="md:col-span-12 py-2 flex justify-between items-center bg-black/40">
       <div class="flex gap-4 text-[10px] text-zinc-600 font-mono">
         <span>CPU: 12%</span>
         <span>MEM: 4.2GB</span>
         <span>NET: CONNECTED</span>
       </div>
    </Panel>

  </div>
</Layout>