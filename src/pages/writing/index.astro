---
import Layout from '@/layouts/Layout.astro'
import Panel from '@/components/Panel.astro'
import WritingDashboard from '@/components/react/WritingDashboard' // Import komponen React
import { getAllWriting } from '@/lib/data-utils'

// 1. Ambil semua data di Server
const allPosts = await getAllWriting()

// 2. Format data agar sesuai dengan props React (serializable JSON)
const postsForReact = allPosts.map(post => ({
  id: post.id,
  title: post.data.title,
  description: post.data.description,
  publishDate: post.data.publishDate,
  category: post.data.category,
  isFeatured: post.data.isFeatured
}))
---

<Layout title="Data Archives">
  <div class="max-w-5xl mx-auto p-4 md:p-8 min-h-screen flex flex-col gap-8">
    
    {/* Header Halaman */}
    <header className="border-b border-zinc-800 pb-6">
      <div class="flex items-center gap-2 mb-2">
        <div class="w-3 h-3 bg-amber-500 animate-pulse"></div>
        <span class="text-xs font-mono text-amber-500 tracking-widest">ARCHIVES // WRITING</span>
      </div>
      <h1 class="text-3xl md:text-4xl font-black font-mono text-white tracking-tighter">
        NEURAL_LOGS
      </h1>
      <p class="text-zinc-500 mt-2 max-w-xl text-sm">
        Kumpulan data, opini, dan catatan teknis. Gunakan terminal di bawah untuk memfilter data.
      </p>
    </header>

    {/* React Island: Dashboard Tab */}
    {/* client:load PENTING agar interaksi Tab berfungsi */}
    <WritingDashboard client:load posts={postsForReact} />

  </div>
</Layout>